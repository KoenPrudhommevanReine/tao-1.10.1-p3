<HTML>
<HEAD>
<!-- This file was generated by tohtml from part2b.tex -->
<!-- with the command
tohtml -default -numbers -mapman www.cit manual.tex -notopnames -mapref ../../manualpages/manualpages.cit -quietlatex 
-->
<TITLE>Limited-Memory, Variable-Metric Method</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<HR><H2><A NAME="Node33">24.2. Limited-Memory, Variable-Metric Method</a></H2>
  
<P> 
The limited-memory, variable-metric method solves the system of equations  
<P><IMG WIDTH=86 HEIGHT=11 SRC="img23.xbm"><P>
  
where <I>H<SUB>k</SUB></I> is a positive definite approximation to the Hessian matrix   
obtained by using the BFGS update formula with a limited number of   
previous iterates and gradient evaluations.  The inverse of <I>H<SUB>k</SUB></I> can   
readily be applied to obtain the direction <I>d<SUB>k</SUB></I>.  Having obtained the   
direction, a More-Thuente line search is applied to compute a step  
length, <IMG WIDTH=9 HEIGHT=6 SRC="img24.xbm">
, that approximately solves the one-dimensional   
optimization problem  
<P><IMG WIDTH=79 HEIGHT=15 SRC="img25.xbm"><P>
  
The current iterate and Hessian approximation are updated and the process  
is repeated until the method converges.  This algorithm is the default   
unconstrained minimization solver and can be selected using the   
TaoMethod <tt> tao_lmvm</tt>.  For best efficiency, function and gradient   
evaluations should be performed simultaneously when using this algorithm.  
<P> 
The primary factors determining the behavior of this algorithm are the   
number of vectors stored for the Hessian approximation and the scaling matrix  
used when computing the direction.  The number of vectors stored can be set  
with the command line argument <tt> -tao_lmm_vectors &lt;int&gt;</tt>; <I>5</I> is the   
default   
value.  Increasing the number of vectors results in a better Hessian   
approximation and can decrease the number of iterations required to compute  
a solution to the optimization problem.  However, as the number of vectors  
increases, more memory is consumed and each direction calculation takes  
longer to compute.  Therefore, a trade off must be made between the   
quality of the Hessian approximation, the memory requirements, and  
the time to compute the direction.  
<P> 
During the computation of the direction, the inverse of an initial   
Hessian approximation <I>H<SUB>0,k</SUB></I> is applied.  The choice of <I>H<SUB>0,k</SUB></I>  
has a significant impact on the quality of the direction obtained  
and can result in a decrease in the number of function and gradient   
evaluations required to solve the optimization problem.  However,  
the calculation of <I>H<SUB>0,k</SUB></I> at each iteration can have a significant   
impact on the time required to update the limited-memory BFGS   
approximation and the cost of obtaining the direction.  By default,   
<I>H<SUB>0,k</SUB></I> is a diagonal matrix obtained from the diagonal entries  
of a Broyden approximation to the Hessian matrix.  The calculation  
of <I>H<SUB>0,k</SUB></I> can be modified with the command line argument   
<tt> -tao_lmm_scale_type &lt;none,scalar,broyden&gt;</tt>.  Each scaling   
method is described below.  The <tt> scalar</tt> and <tt> broyden</tt>   
techniques are inspired by [(ref Gilbert-Lemarachal)].  
<P> 
<dl> 
 
<dt> 
<b>{</b><tt> none}</tt></b><dd> 
This scaling method uses the identity matrix as   
<I>H<SUB>0,k</SUB></I>.  No extra computations are required when obtaining the   
search direction or updating the Hessian approximation.  However,   
the number of functions and gradient evaluations required to converge  
to a solution is typically much larger than the number required when   
using other scaling methods.  
 
<dt> 
<b>{</b><tt> scalar}</tt></b><dd> 
This scaling method uses a multiple of the identity   
matrix as <I>H<SUB>0,k</SUB></I>.  The scalar value <IMG WIDTH=6 HEIGHT=5 SRC="img26.xbm">
 is chosen by solving the   
one-dimensional optimization problem  
<P><IMG WIDTH=106 HEIGHT=16 SRC="img27.xbm"><P>
  
where <IMG WIDTH=41 HEIGHT=11 SRC="img28.xbm">
 is given, and <I>S</I> and <I>Y</I> are the matrices of   
past iterate and gradient information required by the limited-memory  
BFGS update formula.  The optimal value for <IMG WIDTH=6 HEIGHT=5 SRC="img29.xbm">
 can be written  
down explicitly.  This choice of <IMG WIDTH=6 HEIGHT=5 SRC="img30.xbm">
 attempts to satisfy the   
secant equation <IMG WIDTH=37 HEIGHT=7 SRC="img31.xbm">
.  Since this equation cannot typically  
be satisfied by a scalar, a least norm solution is computed.  The amount   
of past iterate and gradient information used is set by the command line   
argument <tt> tao_lmm_scalar_history &lt;int&gt;</tt>, which must be less than   
or equal to the number of vectors kept for the BFGS approximation.    
The default value is 5.  The choice for <IMG WIDTH=7 HEIGHT=5 SRC="img32.xbm">
 is made with the command   
line argument <tt> tao_lmm_scalar_alpha &lt;double&gt;</tt>; <I>1</I> is the default  
value.  This scaling method offers a good compromise between no scaling   
and <tt> broyden</tt> scaling.  
 
<dt> 
<b>{</b><tt> broyden}</tt></b><dd> 
This scaling method uses a positive-definite diagonal   
matrix obtained from the diagonal entries of the Broyden approximation to   
the Hessian for the scaling matrix.  The Broyden approximation is a   
family of approximations parametrized by a constant <IMG WIDTH=6 HEIGHT=9 SRC="img33.xbm">
; <IMG WIDTH=26 HEIGHT=9 SRC="img34.xbm">
   
gives the BFGS formula and <IMG WIDTH=26 HEIGHT=9 SRC="img35.xbm">
 gives the DFP formula.  The value   
of <IMG WIDTH=6 HEIGHT=9 SRC="img36.xbm">
 is set with the command line argument   
<tt> -tao_lmm_broyden_phi &lt;double&gt;</tt>.  The default value for <IMG WIDTH=6 HEIGHT=9 SRC="img37.xbm">
   
is <I>0.125</I>.  This scaling method requires the most computational effort   
of available choices, but typically results in a significant reduction   
in the number of function and gradient evaluations taken to compute a   
solution.  
</dl> 
<BR> 
An additional rescaling of the diagonal matrix can be applied to further  
improve performance when using the <tt> broyden</tt> scaling method.  The  
rescaling method can be set with the command line argument   
<tt> -tao_lmm_rescale_type &lt;none,scalar,gl&gt;</tt>; <tt> scalar</tt> is the   
default rescaling method.  The rescaling method applied can have a large   
impact on the number of function and gradient evaluations necessary to   
compute a solution to the optimization problem, but increases the time  
required to update the BFGS approximation.  Each rescaling method is   
described below.  These techniques are inspired by [(ref Gilbert-Lemarachal)].  
<P> 
<dl> 
 
<dt> 
<b>{</b><tt> none}</tt></b><dd> 
This rescaling method does not modify the diagonal scaling  
matrix.  
 
<dt> 
<b>{</b><tt> scalar}</tt></b><dd> 
This rescaling method chooses a scalar value <IMG WIDTH=6 HEIGHT=5 SRC="img38.xbm">
 by   
solving the one-dimensional optimization problem  
<P><IMG WIDTH=154 HEIGHT=17 SRC="img39.xbm"><P>
  
where <IMG WIDTH=41 HEIGHT=11 SRC="img40.xbm">
 and <IMG WIDTH=40 HEIGHT=11 SRC="img41.xbm">
 are given, <I>H<SUB>0,k</SUB></I> is the   
positive-definite diagonal scaling matrix computed by using the Broyden   
update, and <I>S</I> and <I>Y</I> are the matrices of past iterate and gradient  
information required by the limited-memory BFGS update formula.  This   
choice of <IMG WIDTH=6 HEIGHT=5 SRC="img42.xbm">
 attempts to satisfy the secant equation   
<IMG WIDTH=57 HEIGHT=10 SRC="img43.xbm">
.  Since this equation cannot typically be satisfied   
by a scalar, a least norm solution is computed.  The scaling matrix used is   
then <IMG WIDTH=26 HEIGHT=10 SRC="img44.xbm">
.  The amount of past iterate and gradient information   
used is set by the command line argument   
<tt> tao_lmm_rescale_history &lt;int&gt;</tt>, which must be less than or equal  
to the number of vectors kept for the BFGS approximation.  The default value   
is 5.  The choice for <IMG WIDTH=7 HEIGHT=5 SRC="img45.xbm">
 is made with the command  
line argument <tt> tao_lmm_rescale_alpha &lt;double&gt;</tt>; <I>1</I> is the default  
value.  The choice for <IMG WIDTH=6 HEIGHT=9 SRC="img46.xbm">
 is made with the command line argument   
<tt> tao_lmm_rescale_beta &lt;double&gt;</tt>; <I>0.5</I> is the default value.  
 
<dt> 
<b>{</b><tt> gl}</tt></b><dd> 
This scaling method is the same as the <tt> scalar</tt> rescaling   
method, but the previous value for the scaling matrix <I>H<SUB>0,k-1</SUB></I> is used when   
computing <IMG WIDTH=6 HEIGHT=5 SRC="img47.xbm">
.  This is the rescaling method suggested in   
[(ref Gilbert-Lemarachal)].  
</dl> 
<BR> 
Finally, a limit can be placed on the difference between the scaling  
matrix computed at this iteration and the previous value for the  
scaling matrix.  The limiting type can be set with the command line   
argument <tt> -tao_lmm_limit_type &lt;none,average,relative,absolute&gt;</tt>;  
<tt> none</tt> is the default value.  Each of these methods is described   
below when using the <tt> scalar</tt> scaling method.  The techniques are  
the same when using the <tt> broyden</tt> scaling method, but are applied  
to each entry in the diagonal matrix.  
<P> 
<dl> 
 
<dt> 
<b>{</b><tt> none}</tt></b><dd> 
Set <IMG WIDTH=32 HEIGHT=6 SRC="img48.xbm">
, where <IMG WIDTH=6 HEIGHT=5 SRC="img49.xbm">
 is the value  
computed by the scaling method.  
 
<dt> 
<b>{</b><tt> average}</tt></b><dd> 
Set <IMG WIDTH=108 HEIGHT=11 SRC="img50.xbm">
,   
where <IMG WIDTH=6 HEIGHT=5 SRC="img51.xbm">
 is the value computed by the scaling method, <IMG WIDTH=21 HEIGHT=6 SRC="img52.xbm">
 is  
the previous value, and <IMG WIDTH=40 HEIGHT=11 SRC="img53.xbm">
 is given.  
 
<dt> 
<b>{</b><tt> relative}</tt></b><dd> 
Set <IMG WIDTH=200 HEIGHT=12 SRC="img54.xbm">
,   
where <IMG WIDTH=6 HEIGHT=5 SRC="img55.xbm">
 is the value computed by the scaling method, <IMG WIDTH=21 HEIGHT=6 SRC="img56.xbm">
 is   
the previous value, and <IMG WIDTH=40 HEIGHT=11 SRC="img57.xbm">
 is given.  
 
<dt> 
<b>{</b><tt> absolute}</tt></b><dd> 
Set <IMG WIDTH=171 HEIGHT=12 SRC="img58.xbm">
,   
where <IMG WIDTH=6 HEIGHT=5 SRC="img59.xbm">
 is the value computed by the scaling method, <IMG WIDTH=21 HEIGHT=6 SRC="img60.xbm">
 is   
the previous value, and <IMG WIDTH=5 HEIGHT=5 SRC="img61.xbm">
 is given.  
</dl> 
<BR> 
The value for <IMG WIDTH=7 HEIGHT=7 SRC="img62.xbm">
 is set with the command line argument   
<tt> -tao_lmm_limit_mu &lt;double&gt;</tt>; <I>1</I> is the default value.  
The value for <IMG WIDTH=5 HEIGHT=5 SRC="img63.xbm">
 is set with the command line argument   
<tt> -tao_lmm_limit_nu &lt;double&gt;</tt>.  The default value is 100.    
<P> 
The default values for the scaling are based on many tests using the  
unconstrained problems from the MINPACK-2 test set.  These tests were  
used to narrow the choices to a few sets of values.  These values were  
then run on the unconstrained problems from the CUTEr test set to  
obtain the default values supplied.  
<P> 
<P><A NAME="node33.html#Table2"><IMG WIDTH=494 HEIGHT=299 SRC="img64.xbm"></a><P>

<P>
<HR>
</BODY>
</HTML>
