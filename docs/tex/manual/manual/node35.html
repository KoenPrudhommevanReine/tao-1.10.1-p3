<HTML>
<HEAD>
<!-- This file was generated by tohtml from part2b.tex -->
<!-- with the command
tohtml -default -numbers -mapman www.cit manual.tex -notopnames -mapref ../../manualpages/manualpages.cit -quietlatex 
-->
<TITLE>Newton Line-Search Method</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<HR><H2><A NAME="Node35">24.4. Newton Line-Search Method</a></H2>
  
<P> 
The Newton line-search method solves the symmetric system of equations  
<p><I> 
H<SUB>k</SUB> d<SUB>k</SUB> = -g<SUB>k</SUB> 
</I><p>  
to obtain a step <I>d<SUB>k</SUB></I>, where <I>H<SUB>k</SUB></I> is the Hessian of the objective function  
at <I>x<SUB>k</SUB></I> and <I>g<SUB>k</SUB></I> is the gradient of the objective function at <I>x<SUB>k</SUB></I>.  
For problems where the Hessian matrix is indefinite, the perturbed system  
of equations  
<P><IMG WIDTH=94 HEIGHT=11 SRC="img67.xbm"><P>
  
is solved to obtain the direction, where <IMG WIDTH=9 HEIGHT=7 SRC="img68.xbm">
 is a positive constant.  
If the direction computed is not a descent direction, the (scaled) steepest   
descent direction is used instead.  Having obtained the direction,   
a More-Thuente line search is applied to obtain a step length,   
<IMG WIDTH=9 HEIGHT=6 SRC="img69.xbm">
, that approximately solves the one-dimensional optimization   
problem  
<P><IMG WIDTH=79 HEIGHT=15 SRC="img70.xbm"><P>
  
The Newton line-search method can be set using the TaoMethod <tt> tao_nls</tt>.  
For the best efficiency, function and gradient evaluations should be   
performed simultaneously when using this algorithm.  
<P> 
The system of equations is approximately solved by applying the conjugate   
gradient method, Steihaug-Toint conjugate gradient method, generalized   
Lanczos method, or an alternative Krylov subspace method   
supplied by PETSc.  The method used to solve the systems of equations is   
specified with the command line argument   
<tt> -tao_nls_ksp_type &lt;cg,stcg,gltr,petsc&gt;</tt>; <tt> cg</tt>   
is the default.  When the type is set to <tt> petsc</tt>, the method set with   
the PETSc <tt> -ksp_type</tt> command line argument is used.  For example, to   
use GMRES as the linear system solver, one would use the the command line   
arguments <tt> -tao_nls_ksp_type petsc -ksp_type gmres</tt>.  Internally,  
the PETSc implementations for the conjugate gradient methods and the   
generalized Lanczos method are used.  See the PETSc manual for further   
information on changing the behavior of the linear system solvers.    
<P> 
A good preconditioner reduces the number of iterations required to  
solve the linear system of equations.  For the conjugate gradient  
methods and generalized Lanczos method, this preconditioner must be  
symmetric and positive definite.  The available options are to use no  
preconditioner, the absolute value of the diagonal of the Hessian  
matrix, a limited-memory BFGS approximation to the Hessian matrix, or  
one of the other preconditioners provided by the PETSc package.  These  
preconditioners are specified by the command line argument   
<tt> -tao_nls_pc_type &lt;none,ahess,bfgs,petsc&gt;</tt>, respectively. The  
default is the <tt> bfgs</tt> preconditioner.  When the preconditioner  
type is set to <tt> petsc</tt>, the preconditioner set with the PETSc   
<tt> -pc_type</tt> command line argument is used.  For example, to use an  
incomplete Cholesky factorization for the preconditioner, one would  
use the command line arguments   
<tt> -tao_nls_pc_type petsc -pc_type icc</tt>.  See the PETSc manual   
for further information on changing the behavior of the preconditioners.  
<P> 
The choice of scaling matrix can have a significant impact on the quality   
of the Hessian approximation when using the <tt> bfgs</tt> preconditioner and  
affect the number of iterations required by the linear system solver.  
The choices for scaling matrices are the same as those discussed for   
the limited-memory, variable-metric algorithm.  For Newton methods,  
however, the option exists to use a scaling matrix based on the true  
Hessian matrix.  In particular, the implementation supports using the   
absolute value of the diagonal of the Hessian matrix or the absolute   
value of the diagonal of the perturbed Hessian matrix.  The scaling   
matrix to use with the <tt> bfgs</tt> preconditioner is set with the   
command line argument <tt> -tao_nls_bfgs_scale_type &lt;bfgs,ahess,phess&gt;</tt>;   
<tt> phess</tt> is the default.  The <tt> bfgs</tt> scaling matrix is derived from   
the BFGS options.  The <tt> ahess</tt> scaling matrix is the absolute value of   
the diagonal of the Hessian matrix.  The <tt> phess</tt> scaling matrix is  
the absolute value of the diagonal of the perturbed Hessian matrix.  
<P> 
The perturbation <IMG WIDTH=9 HEIGHT=7 SRC="img71.xbm">
 is added when the direction returned by the  
Krylov subspace method is either not a descent direction, the Krylov method  
diverged due to an indefinite preconditioner or matrix, or a direction of   
negative curvature was found.  In the two latter cases, if the step returned  
is a descent direction, it is used during the line search.  Otherwise, a  
steepest descent direction is used during the line search.  The perturbation  
is decreased as long as the Krylov subspace method reports success and   
increased if further problems are encountered.  There are three cases:  
initializing, increasing, and decreasing the perturbation.  These cases  
are described below.  
<ol> 
 
1. If <IMG WIDTH=9 HEIGHT=7 SRC="img72.xbm">
 is zero and a problem was detected with either the  
direction on the Krylov subspace method, the perturbation is initialized to  
<P><IMG WIDTH=215 HEIGHT=12 SRC="img73.xbm"><P>
  
where <tt> imin</tt> is set with the command line argument   
<tt> -tao_nls_imin &lt;double&gt;</tt> with a default value of <I>10<SUP>-4</SUP></I>,  
<tt> imfac</tt> by <tt> -tao_nls_imfac</tt> with a default value of 0.1, and   
<tt> imax</tt> by <tt> -tao_nls_imax</tt> with a default value of 100.    
When using the <tt> gltr</tt> method to solve the system of equations, an  
estimate of the minimum eigenvalue <IMG WIDTH=9 HEIGHT=8 SRC="img74.xbm">
 of the Hessian matrix   
is available.  This value is use to initialize the perturbation to  
<IMG WIDTH=115 HEIGHT=12 SRC="img75.xbm">
.  
 
<BR> 
2. If <IMG WIDTH=9 HEIGHT=7 SRC="img76.xbm">
 is nonzero and a problem was detected with either the   
direction or Krylov subspace method, the perturbation is increased to   
<P><IMG WIDTH=268 HEIGHT=12 SRC="img77.xbm"><P>
  
where <tt> pgfac</tt> is set with the command line argument <tt> -tao_nls_pgfac</tt>  
with a default value of 10, <tt> pmgfac</tt> by <tt> -tao_nls_pmgfac</tt> with a  
default value of 0.1, and <tt> pmax</tt> by <tt> -tao_nls_pmax</tt> with a default  
value of 100.  
 
<BR> 
3. If <IMG WIDTH=9 HEIGHT=7 SRC="img78.xbm">
 is nonzero and no problems were detected with either  
the direction or Krylov subspace method, the perturbation is decreased to  
<P><IMG WIDTH=202 HEIGHT=12 SRC="img79.xbm"><P>
  
where <tt> psfac</tt> is set with the command line argument <tt> -tao_nls_psfac</tt>  
with a default value of 0.4, and <tt> pmsfac</tt> by <tt> -tao_nls_pmsfac</tt> with  
a default value of 0.1.  Moreover, if <IMG WIDTH=60 HEIGHT=9 SRC="img80.xbm">
 then   
<IMG WIDTH=41 HEIGHT=9 SRC="img81.xbm">
, where <tt> pmin</tt> is set with the command line argument   
<tt> -tao_nls_pmin</tt> and has a default value of <I>10<SUP>-12</SUP></I>.  
</ol> 
When using <tt> stcg</tt> or <tt> gltr</tt> to solve the linear systems of equation,  
a trust-region radius need to be initialized and updated.  This trust-region  
radius limits the size of the step computed.  The method for initializing  
the trust-region radius is set with the command line argument   
<tt> -tao_nls_init_type &lt;constant,direction,interpolation&gt;</tt>;  
<tt> interpolation</tt>, which chooses an initial value based on the   
interpolation scheme found in [(ref CGT)], is the default.  This  
scheme performs a number of function and gradient evaluations to determine   
a radius such that the reduction predicted by the quadratic model along the   
gradient direction coincides with the actual reduction in the nonlinear   
function.  The iterate obtaining the best objective function value is   
used as the starting point for the main line-search algorithm.  The   
<tt> constant</tt> method initializes the trust-region radius by using   
the value specified with the <tt> -tao_trust0 &lt;double&gt;</tt> command line   
argument, where the default value is 100.  The <tt> direction</tt> technique   
solves the first quadratic optimization problem by using a standard   
conjugate gradient method and initializes the trust-region to   
<IMG WIDTH=18 HEIGHT=11 SRC="img82.xbm">
.  
<P> 
Finally, the method for updating the trust-region radius is set with the   
command line argument   
<tt> -tao_nls_update_type &lt;step,reduction,interpolation&gt;</tt>; <tt> step</tt>   
is the default.  The <tt> step</tt> method updates the trust-region   
radius based on the value of <IMG WIDTH=9 HEIGHT=6 SRC="img83.xbm">
.  In particular,  
<P><IMG WIDTH=210 HEIGHT=65 SRC="img84.xbm"><P>
  
where <IMG WIDTH=155 HEIGHT=8 SRC="img85.xbm">
 and  
<IMG WIDTH=103 HEIGHT=8 SRC="img86.xbm">
 are constants.  The <tt> reduction</tt>   
method computes the ratio of the actual reduction in the objective function   
to the reduction predicted by the quadratic model for the full step,   
<IMG WIDTH=90 HEIGHT=17 SRC="img87.xbm">
, where   
<I>q<SUB>k</SUB></I> is the quadratic model.  The radius is then updated as:  
<P><IMG WIDTH=220 HEIGHT=65 SRC="img88.xbm"><P>
  
where <IMG WIDTH=156 HEIGHT=8 SRC="img89.xbm">
 and  
<IMG WIDTH=103 HEIGHT=9 SRC="img90.xbm">
 are constants.  The <tt> interpolation</tt>  
method uses the same interpolation mechanism as in the initialization to  
compute a new value for the trust-region radius.  
<P> 
<P><A NAME="node35.html#Table3"><IMG WIDTH=494 HEIGHT=448 SRC="img91.xbm"></a><P>
<P><A NAME="node35.html#Table4"><IMG WIDTH=489 HEIGHT=529 SRC="img92.xbm"></a><P>

<P>
<HR>
</BODY>
</HTML>
