<HTML>
<HEAD>
<!-- This file was generated by tohtml from part2b.tex -->
<!-- with the command
tohtml -default -numbers -mapman www.cit manual.tex -notopnames -mapref ../../manualpages/manualpages.cit -quietlatex 
-->
<TITLE>Newton Trust-Region Method</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<HR><H2><A NAME="Node36">24.5. Newton Trust-Region Method</a></H2>
  
<P> 
The Newton trust-region method solves the constrained quadratic programming  
problem  
<P><IMG WIDTH=128 HEIGHT=27 SRC="img93.xbm"><P>
  
to obtain a direction <I>d<SUB>k</SUB></I>, where <I>H<SUB>k</SUB></I> is the Hessian of the objective   
function at <I>x<SUB>k</SUB></I>, <I>g<SUB>k</SUB></I> is the gradient of the objective function at <I>x<SUB>k</SUB></I>   
and <IMG WIDTH=12 HEIGHT=9 SRC="img94.xbm">
 is the trust-region radius.  If <I>x<SUB>k</SUB> + d<SUB>k</SUB></I> sufficiently   
reduces the nonlinear objective function, then the step is accepted and the   
trust-region radius is updated.  However, if <I>x<SUB>k</SUB> + d<SUB>k</SUB></I> does not sufficiently  
reduce the nonlinear objective function, then the step is rejected, the   
trust-region radius is reduced, and the quadratic program is re-solved   
using the updated trust-region radius. The Newton trust-region method   
can be set using TaoMethod <tt> tao_ntr</tt>.  For the best efficiency,   
function and gradient evaluations should be performed separately when   
using this algorithm.  
<P> 
The quadratic optimization problem is approximately solved by applying  
the Steihaug-Toint conjugate gradient method or generalized Lanczos   
method to the symmetric system of equations <I>H<SUB>k</SUB> d = -g<SUB>k</SUB></I>.  The method   
used to solve the system of equations is specified with the command line  
argument <tt> -tao_ntr_ksp_type &lt;stcg,gltr&gt;</tt>; <tt> stcg</tt> is the default.    
Internally, the PETSc implementations for the Steihaug-Toint method and the   
generalized Lanczos method are used.  See the PETSc manual for further   
information on changing the behavior of these linear system solvers.    
<P> 
A good preconditioner reduces the number of iterations required to  
compute the direction.  For the Steihaug-Toint conjugate gradient  
method and generalized Lanczos method, this preconditioner must be  
symmetric and positive definite.  The available options are to use no  
preconditioner, the absolute value of the diagonal of the Hessian  
matrix, a limited-memory BFGS approximation to the Hessian matrix, or  
one of the other preconditioners provided by the PETSc package.  These  
preconditioners are specified by the the command line argument   
<tt> -tao_ntr_pc_type &lt;none,ahess,bfgs,petsc&gt;</tt>, respectively.  The  
default is the <tt> bfgs</tt> preconditioner.  When the preconditioner  
type is set the to <tt> petsc</tt>, the preconditioner set with the PETSc  
<tt> -pc_type</tt> command line argument is used.  For example, to use an  
incomplete Cholesky factorization for the preconditioner, one would  
use the command line arguments   
<tt> -tao_ntr_pc_type petsc -pc_type icc</tt>.  See the PETSc manual   
for further information on changing the behavior of the preconditioners.  
<P> 
The choice of scaling matrix can have a significant impact on the quality   
of the Hessian approximation when using the <tt> bfgs</tt> preconditioner and  
affect the number of iterations required by the linear system solver.  
The choices for scaling matrices are the same as those discussed for   
the limited-memory, variable-metric algorithm.  For Newton methods,  
however, the option exists to use a scaling matrix based on the true  
Hessian matrix.  In particular, the implementation supports using the   
absolute value of the diagonal of the Hessian matrix.  The scaling   
matrix to use with the <tt> bfgs</tt> preconditioner is set with the   
command line argument <tt> -tao_ntr_bfgs_scale_type &lt;ahess,bfgs&gt;</tt>;   
<tt> ahess</tt> is the default.  The <tt> bfgs</tt> scaling matrix is derived from   
the BFGS options.  The <tt> ahess</tt> scaling matrix is the absolute value of   
the diagonal of the Hessian matrix.  
<P> 
The method for computing an initial trust-region radius is set with the   
command line argument <tt> -tao_ntr_init_type &lt;constant,direction,interpolation&gt;</tt>;  
<tt> interpolation</tt>, which chooses an initial value based on the   
interpolation scheme found in [(ref CGT)], is the default.  This  
scheme performs a number of function and gradient evaluations to determine   
a radius such that the reduction predicted by the quadratic model along the   
gradient direction coincides with the actual reduction in the nonlinear   
function.  The iterate obtaining the best objective function value is   
used as the starting point for the main line-search algorithm.  The   
<tt> constant</tt> method initializes the trust-region radius by using   
the value specified with the <tt> -tao_trust0 &lt;double&gt;</tt> command line   
argument, where the default value is 100.  The <tt> direction</tt> technique   
solves the first quadratic optimization problem by using a standard   
conjugate gradient method and initializes the trust-region to   
<IMG WIDTH=18 HEIGHT=11 SRC="img95.xbm">
.  
<P> 
Finally, the method for updating the trust-region radius is set with the   
command line argument   
<tt> -tao_ntr_update_type &lt;reduction,interpolation&gt;</tt>; <tt> reduction</tt>   
is the default.  The <tt> reduction</tt> method computes the ratio of the   
actual reduction in the objective function to the reduction predicted   
by the quadratic model for the full step,   
<IMG WIDTH=90 HEIGHT=17 SRC="img96.xbm">
, where   
<I>q<SUB>k</SUB></I> is the quadratic model.  The radius is then updated as:  
<P><IMG WIDTH=220 HEIGHT=65 SRC="img97.xbm"><P>
  
where <IMG WIDTH=156 HEIGHT=8 SRC="img98.xbm">
 and  
<IMG WIDTH=103 HEIGHT=9 SRC="img99.xbm">
 are constants.  The <tt> interpolation</tt>  
method uses the same interpolation mechanism as in the initialization to  
compute a new value for the trust-region radius.  
<P> 
<P><A NAME="node36.html#Table5"><IMG WIDTH=494 HEIGHT=475 SRC="img100.xbm"></a><P>

<P>
<HR>
</BODY>
</HTML>
