<html>
<head><title>Documentation for SIDL Interface Tools for TAO</title></head>
<body bgcolor="#FFFFFF">
<center><a href="http://www.mcs.anl.gov/tao">[Go to TAO Home Page]</a></center>

<h2>Documentation for SIDL Interface Tools for TAO</h2>

Directory: src/sidl <br>
Contents: SIDL interface tools for TAO <br>

<h3>Subdirectories:</h3>
<ul>
<li><b>sidlfiles</b> - Contains all the SIDL (Scientific Interface Definition Language) files that are used.

<li><b>xml</b> - Will contain all the xml repositories corresponding
to the SIDL files.  Since these are Babel-generated, they are not
included in the distribution.  To create the xml repositories run
'make xml' from src/sidl 

<li><b>clients</b> - Contains all the client stubs of the SIDL files (in C, C++, and F77).  Upon cloning from the bitkeeper repository, these directories are empty (except for makefile templates) because the files are all generated by Babel.  cd to the clients directory and type 'make stubs' to generate these files, and 'make libs' to make the client libraries.  All of the client libraries will be placed in the
clients/libs directory.  There are no (or at least shouldn't be) any clients for the components since the server libraries are dynamically loaded using SIDL.Loader.  Only the abstract SIDL interfaces for the components need client stubs.

<li><b>servers</b> - Contains the implementation of classes.

<li><b>interface</b> - Defines the TaoSIDLApplication class, which descends from TaoApplication 
	(see $TAO_DIR/include/taoappobject.c) and is an adaptor for the SIDL 
	class TAOAPI_Application.

<li><b>examples</b> - Contains the example drivers.  Run 'make' for the 
Rosenbrock examples (with drivers in C, C++, and F77; models implemented 
in C, C++, and F77)


<li><b>components</b> - Contains the various components.


</ul>

<hr>
<h3>Dependencies:</h3>
In addition to standard TAO dependencies (<a href="http://www.mcs.anl.gov/petsc">PETSc</a>, 
<a href="http://www.mcs.anl.gov/mpi">MPI</a>), a distribution of 
<a href="http://www.llnl.gov/CASC/components/babel.html">Babel</a>
is required to 
use the SIDL interface.  
(Version 1.6 of TAO uses version 0.8.8 of Babel; other versions may or may not be compatible.) 
<p>To use the examples that employ the CCA reference framework, 
<a href="http://www.cca-forum.org/ccafe">Ccaffeine</a> version 0.4.3 should 
be used.  Instructions for dowload can be found at
<a href="http://www.cca-forum.org/old/ccafe/Ccaffeine_Build_Example.html">cca-forum.org</a>. 



<hr>
<h3>Building:</h3>
<ol>
<li> In the bmake/packages/${PETSC_ARCH} file, specify the location of the Babel distribution, the
Babel sh script, and the location of ccafe information if you wish to use Ccaffeine components.
<li> To build the Ccaffeine components, set the location of the cca-spec-classic, cca-spec-babel, and ccafe directories in the bmake/packages.${PETSC_ARCH} file.
<li> Compile TAO according to standard <a href="http://www.mcs.anl.gov/tao/docs/installation/unix.htm">
installation instructions</a>.  If PETSc is already installed, then you should only have to set the 
TAO_DIR environment variable and run 'make'.

</ol>

<hr>
<h3>Writing your own model implementation:</h3>

This can be done by writing your own SIDL file that declares a class implementing all
of the methods in the Optimize.OptimizationModel interface (declared in the file 
<a href = "./sidlfiles/Optimize.sidl">Optimize.sidl</a>;
see <a href = "./sidlfiles/Rosenbrock.sidl">Rosenbrock.sidl</a> for an example.
Run Babel on your SIDL file to create C++ client files for TAO to access, client files
for whatever language your driver will employ, and server files for your implementation.
(If the driver is also in C++, then it can use the same library that TAO uses.)
For example, to build your model in F77 and use F77 in your driver program, use:
<p>
<pre>
  %babel -cC++ -o{C++ client directory} -R$TAO_DIR/src/sidl/repositories/Optimize {your SIDL file}
  %babel -cF77 -o{F77 client directory} -R$TAO_DIR/src/sidl/repositories/Optimize {your SIDL file}
  %babel -sF77 -o{F77 server directory} -R$TAO_DIR/src/sidl/repositories/Optimize {your SIDL file}
</pre>
<p>
The -R flag indicates the location TAO places the xml parsing of the Optimize.OptimizeModel interface.

<p>
Now you need to edit the files in the server directory with the '_Impl' endings -- you
should not need to edit any other files -- to perform the desired implementations. 
<p>
For examples, see 
  <a href="./servers/Rosenbrock/Rosenbrock-server-C++/Rosenbrock_RosenbrockModel_Impl.cc">
Rosenbrock_RosenbrockModel_Impl.cc</a> and 
  <a href = "./servers/Rosenbrock/Roenbrock-server-C++/Rosenbrock_RosenbrockModel_Impl.hh">
Rosenbrock_RosenbrockModel_Impl.hh</a>
for a C++ implementation, or 
  <a href="./servers/Rosenbrock/Rosenbrock-server-F77/Rosenbrock_RosenbrockModel_Impl.f">
Rosenbrock_RosenbrockModel_Impl.f</a>
for a F77 implementation.


<p>
For references on implementing SIDL functions and accessing SIDL arrays, see the 
<a href= "http://www.llnl.gov/CASC/components/babel.html">Babel documentation.</a>

<p>
Next, the various client and server files must be compiled, and ideally built into 
shared libraries.  Again, see the Babel documentation and RosenbrockModel examples.

<p>
Finally, you must compile your driver (see example drivers in 
<a href="./examples/rosenbrockcc.cc">C++</a>, <a href="./examples/rosenbrockc.c">C</a>,
 and <a href="./examples/rosenbrockf.F">F77</a>) and
link with the necessary client and server libraries, the TAO and PETSc libraries,
and the Babel runtime library. (<a href="./examples/makefile">see example makefile</a>).

<hr>

<h3> Using Components </h3>
We have included five components that can be used the 
Ccaffeine (SIDL-enabled version) framework to run a sample program:


Review the SIDL and source files for more information on the components:
<ul>
<li> <a href="./sidlfiles/Solver.sidl">Solver.sidl</a> 
     -- defines Solver.OptimizationSolver interface.
<li> <a href="./sidlfiles/Optimize.sidl">Optimize.sidl</a> 
     -- defines Optimize.OptimizationSolver interface.

<li> TaoSolver.Component is a concrete implementation of the interface 
Solver.OptimizationSolver. 

<li> Minsurf.Component is an implementation of the 
Optimize.OptimizationModel interface (evaluateObectiveFunction, evaluteGradient, evaluateHessian, etc.).

<li> TaoDriver.Component implements [gov.]cca.GoPort and connects
with a Solver.OptimizationSolver interface.

<li> PetscFactory implements the LinearAlgebra interface (see
LAFactory.sidl).
<li> GAFactory is another implementation of the LinearAlgebra interface using Global Arrays.
<li> <a href="./components/CCAFERC.in">CCAFERC</a> 
      -- ccaffeine script for running TaoSolver, Minsurf, PetscFactory, and TaoDriver.
<li> After compiling, the Minsurf example can be run with the command:
  <pre>(ccaffeine_install_dir)/bin/ccafe-single --ccafe-rc $TAO_DIR/src/sidl/CCAFERC</pre>
</ul>

<hr>

If you have any questions at all, please feel free to email us at 
<a href="mailto:tao-comments@mcs.anl.gov">tao-comments@mcs.anl.gov</a>.


<p>


<center><a href="http://www.mcs.anl.gov/tao">[Go to TAO Home Page]</a></center>
</body>
</html>



